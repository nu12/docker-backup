  
<%= form_with(url: "/backup/selected", method: "post", class: "d-inline") do |f| %>
  <%= f.submit "Backup selected", class: "btn btn-sm btn-success" %>
  <%= link_to 'Backup all', '/backup/all', class: "btn btn-sm btn-success" %>

  <table class="table table-striped">
    <thead>
      <tr>
        <th><input type="checkbox" id="check-all"></th>
        <th>Name</th>
        <th>Mountpoint</th>
        <th>CreatedAt</th>
        <th></th>
        <th></th>
      </tr>
    </thead>
    <tbody>
  <% volumes.each do |volume| %>
  <tr>
      <td><input value="<%= volume['Name'] %>" type="checkbox" name="volumes[]" class="form-checkbox"></td>
      <td><%= volume["Name"].size > 24 ? "#{volume["Name"][0,21]}..." : volume["Name"]  %></td>
      <td><%= volume["Mountpoint"].size > 42 ? "#{volume["Mountpoint"][0,39]}..." : volume["Mountpoint"] %></td>
      <td><%= volume["CreatedAt"] %></td>
      <td class="icon-<%= volume['Name'] %>"></td>
      <td>
        <%= link_to 'Create backup', "#", {class:"btn btn-success btn-sm", 'data-bs-toggle'=>"modal", 'data-bs-target'=>"#modal-#{volume['Name']}"} %>

        <!-- Quick backup button -->
        <%= form_with(url: "/backup/create", method: "post", class: "d-inline") do |form| %>
          <%= form.hidden_field :name, value: volume['Name'], readonly: "readonly" %>
          <%= form.hidden_field :file, value: volume['Name'], readonly: "readonly" %>
          <%= button_tag type: 'submit', class: "btn btn-success btn-sm", title: "Quick backup", "data-bs-toggle" => "tooltip", "data-bs-placement"=>"top" do %>
            <i class="fas fa-tachometer-alt"></i>
          <% end %>
        <% end %>

        <%= link_to "/volume/#{volume["Name"]}", method: :delete, data: { confirm: 'Are you sure?' }, class:"btn btn-danger btn-sm", title: "Delete volume", "data-bs-toggle" => "tooltip", "data-bs-placement"=>"top" do %>
          <i class="fas fa-trash-alt"></i>
        <% end %>
      </td>
  </tr>
  <% end %>
  </tbody>
  </table>
<% end %>

<% volumes.each do |volume| %>

<!-- Modal -->
<div class="modal fade" id="modal-<%= volume['Name'] %>" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Create new backup file</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= form_with(url: "/backup/create", method: "post") do |form| %>

          <div class="form-group">
              <%= form.label :name, "Volume name" %>
              <%= form.text_field :name, value: volume['Name'], readonly: "readonly", class: "form-control"  %>
          </div>

          <div class="form-group">
              <%= form.label :file, "Backup file name" %>
              <%= form.text_field :file, value: volume['Name'], class: "form-control" %>
          </div>

          <div class="mt-3 actions">
              <%= form.submit "Create", class: "btn btn-success form-control" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
<% end %>